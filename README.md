# NHP-COVID-19
Source code of manuscript: [Single-cell atlas of a non-human primate reveals new pathogenic mechanisms of COVID-19](https://www.biorxiv.org/content/10.1101/2020.04.10.022103v1)

**Requirements**  
**1.** These scripts have been tested on Windows or Linux, but should be supported by Mac OSX.  
**2.** Users should have R version 3.5 or higher, python version 3.6, and several packages as indicated in the scripts.


<font size=5>**Descriptions of the scripts**</font>  
01.Clustering_organ9_Figure2AB_4D.py  
   Clustering analysis of all single cells within our dataset, and UMAP projection of ACE2, TMPRSS2, TMEM27, IDO2, DNAJC12 and ANPEP expression in all single cells.
   
02.Figure1BC_FigureS1.R  
   UMAP visualization of all single cells from the dataset colored by tissue/organ and 44 clusters in the first round of clustering.   
   
03.Figure2CDE.R  
   UMAP projection of ACE2<sup>+</sup>/TMPRSS2<sup>+</sup> cells; Bubble plots showing the level of expression of TMPRSS2 and ACE2 genes and the ratio of expressing cells in the indicated cell types; Barplot indicating the percentage of ACE2 and TMPRSS2 expressing cells within each cell cluster.  
 
expressing cells in the indicated cell types.   
04.Figure3.R  
   Output Figure 3 in manuscript.  
05.Figure4ABC.R  
   Output Figure 4ABC in manuscript.  
06.Figure5BCDG_FigureS5AB.R  
   Output Figure 5BCDG in manuscript.  
07.Figure5E.R  
   Output Figure 5E in manuscript.  
08.Figure5H_left_FigureS5D.py  
   Output Figure 5H left in manuscript.  
09.Figure5H_right.R  
   Output Figure 5H right in manuscript.  
10.FigureS2.R  
   Clustering analysis of cells from each organ, then output Figure S2 in manuscript.  
11.FigureS3.R  
   Output Figure S3 in manuscript.  
12.FigureS4ABC.R  
   Output Figure S4ABC in manuscript.  

**Data availability**  
All raw sequencing data will be made available upon request at the peer review stage, and accession codes will be available before publication.

